url<-paste0(FTSE_URL,CODE2[[i]])
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE$company_code<-CODE[[i]]
FTSE_R_TABLE_LIST[[i]]<-FTSE_TABLE
print(i)
}
for (i in 334:length(CODE2)){
FTSE_URL<-"https://www.reuters.com/finance/stocks/company-officers/"
url<-paste0(FTSE_URL,CODE2[[i]])
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE$company_code<-CODE[[i]]
FTSE_R_TABLE_LIST[[i]]<-FTSE_TABLE
print(i)
}
for (i in 336:length(CODE2)){
FTSE_URL<-"https://www.reuters.com/finance/stocks/company-officers/"
url<-paste0(FTSE_URL,CODE2[[i]])
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE$company_code<-CODE[[i]]
FTSE_R_TABLE_LIST[[i]]<-FTSE_TABLE
print(i)
}
for (i in 337:length(CODE2)){
FTSE_URL<-"https://www.reuters.com/finance/stocks/company-officers/"
url<-paste0(FTSE_URL,CODE2[[i]])
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE$company_code<-CODE[[i]]
FTSE_R_TABLE_LIST[[i]]<-FTSE_TABLE
print(i)
}
for (i in 348:length(CODE2)){
FTSE_URL<-"https://www.reuters.com/finance/stocks/company-officers/"
url<-paste0(FTSE_URL,CODE2[[i]])
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE$company_code<-CODE[[i]]
FTSE_R_TABLE_LIST[[i]]<-FTSE_TABLE
print(i)
}
for (i in 349:length(CODE2)){
FTSE_URL<-"https://www.reuters.com/finance/stocks/company-officers/"
url<-paste0(FTSE_URL,CODE2[[i]])
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE$company_code<-CODE[[i]]
FTSE_R_TABLE_LIST[[i]]<-FTSE_TABLE
print(i)
}
missing_code<-c(6,7,8,9,18,21,25,26,28,31,38,40,42,43,50,55,
61,63,71,72,73,80,85,92,93,99,107,111,119,121,
126,133,135,142,143,145,148,153,164,168,169,171,
176,185,195,201,203,204,213,217,219,220,225,228,
229,230,234,238,239,241,243,251,256,257,268,269,
278,292,295,296,305,310,311,314,322,325,326,328,
333,335,336,347,348)
REUTER_SCRAPE_DF<-map_df(FTSE_R_TABLE_LIST,data.frame)
View(REUTER_SCRAPE_DF)
length(missing_code)
length(CODE2)
351-83
length(unique(REUTER_SCRAPE_DF$company_code))
REUTER_SCRAPE_DF<-map_df(FTSE_R_TABLE_LIST,data.frame)[,1:5]
REUTER_SCRAPE_DF$company_name<-REUTER_SCRAPE_DF$company_code
REUTER_SCRAPE_DF$company_name<-FTSE_MEM$NAME[match(REUTER_SCRAPE_DF$company_name,
FTSE_MEM$CODE)]
write.csv(REUTER_SCRAPE_DF,"REUTER_SCRAPE_DF.csv")
MISSING_LIST<-list()
j<-1
R<-missing_code[[j]]
R
RR<-CODE[R]
CODE[6]
MEM_M<-dplyr::filter(FTSE_MEM,CODE==RR)
for (j in 1:length(missing_code)){
R<-missing_code[[j]]
RR<-CODE[R]
MEM_M<-dplyr::filter(FTSE_MEM,CODE==RR)
MISSING_LIST[[j]]<-MEM_M
}
REUTER_MISSING<-map_df(MISSING_LIST,data.frame)
write.csv(REUTER_MISSING,"REUTER_MISSING.csv")
library(xlsx)
library(readxl)
F18<-read_excel("FTSE_350_FIRM_LIST.xlsx")
F18<-read_excel("FTSE_350_FIRM_LIST.xlsx",sheet = "2018-11")
F19<-read_xlsx("FTSE_350_FIRM_LIST.xlsx",sheet = "2019-08-16")
View(F19)
code_19<-F19$CODE
code_18<-F18$CODE
name19<-F19$NAME
name18<-F18$NAME
setdiff(name19,name18)
setdiff(code_18,code_19)
setdiff(name18,name19)
setdiff(name18,name19)
setdiff(name19,name18)
name18
name19
name19[1:10]
name18[1:10]
setdiff(name18,name19)
setdiff(name19,name18)
intersect(name18,name19)
#In 18 not 19
setdiff(name18,name19)
#In 19 not 18
setdiff(name19,name18)
#In 18 not 19
LEAVE<-write.csv(setdiff(name18,name19),"LEAVE18.csv")
#In 19 not 18
JOINED<-write.csv(setdiff(name19,name18),"JOINED19.csv"
)
library(CompaniesHouse)
mkey<-"2tv2rSV-ox3QsyNKFHnZwfgCB-sNtUNFZTgipTzH"
#In 19 not 18
JOINED<-setdiff(name19,name18)
#In 18 not 19
LEAVE<-setdiff(name18,name19)
SEARCH1<-CompanySearch_limit(JOINED[[1]])
SEARCH1<-CompanySearch_limit(JOINED[[1]],mkey)
View(SEARCH1)
library(dplyr)
SEARCH1<-CompanySearch_limit(JOINED[[1]],mkey)%>%filter(company.type=="plc")
View(SEARCH1)
SEARCH1<-CompanySearch_limit(JOINED[[2]],mkey)%>%
filter(company.type=="plc")
View(SEARCH1)
SEARCH1<-CompanySearch_limit(JOINED[[3]],mkey)%>%
filter(company.type=="plc")
View(SEARCH1)
SEARCH_LIST<-list()
for (i in 1:length(JOINED)){
SEARCH1<-CompanySearch_limit(JOINED[[i]],mkey)%>%
filter(company.type=="plc")
SEARCH_LIST[[i]]<-SEARCH1
}
SEARCH1<-CompanySearch_limit(JOINED[[6]],mkey)%>%
filter(company.type=="plc")
for (i in 16:length(JOINED)){
SEARCH1<-CompanySearch_limit(JOINED[[i]],mkey)%>%
filter(company.type=="plc")
SEARCH_LIST[[i]]<-SEARCH1
}
SEARCH1<-CompanySearch_limit(JOINED[[16]],mkey)%>%
filter(company.type=="plc")
View(SEARCH1)
for (i in 17:length(JOINED)){
SEARCH1<-CompanySearch_limit(JOINED[[i]],mkey)%>%
filter(company.type=="plc")
SEARCH_LIST[[i]]<-SEARCH1
}
library(purrr)
SEARCH_DF<-map_df(SEARCH_LIST,data.frame)
write.csv(SEARCH_DF,"SEARCH_DF.csv")
SEARCH1<-CompanySearch_limit(JOINED[[4]],mkey)%>%
filter(company.type=="plc")
SEARCH1<-CompanySearch_limit(JOINED[[4]],mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("APAX GLOBAL ALPHA LIMITED",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("LAW DEBENTURE CORPORATION PLC ",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("F&C INVESTMENT TRUST",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("FLUTTER ENTERTAINMENT PLC",mkey)#%>%
SEARCH1<-CompanySearch_limit("FLUTTER ENTERTAINMENT PLC",mkey)%>%
filter(company.type=="plc")
SEARCH1<-CompanySearch_limit("FLUTTER ENTERTAINMENT",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("NB GLOBAL FLOATING RATE",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("NETWORK INTERNATIONAL HOLDINGS",mkey)#%>%
SEARCH1<-CompanySearch_limit("NEXTENERGY SOLAR FUND",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("OXFORD INSTRUMENTS",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("PHOENIX GROUP HOLDINGS",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("PHOENIX GROUP HOLDINGS PLC",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("PPHE HOTEL GROUP",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("RESTAURANT GROUP PLC ",mkey)#%>%
View(SEARCH1)
SEARCH1<-CompanySearch_limit("RESTAURANT GROUP PLC",mkey)%>%
filter(company.type=="plc")
SEARCH1<-CompanySearch_limit("WOODFORD PATIENT CAPITAL TRUST",mkey)%>%
filter(company.type=="plc")
View(SEARCH1)
library(rversions)
library(rvest)
FTSE_MEM<-read_xlsx("FTSE_350_FIRM_LIST.xlsx",sheet = "2019-08-16")
library(readxl)
FTSE_MEM<-read_xlsx("FTSE_350_FIRM_LIST.xlsx",sheet = "2019-08-16")
CODE<-FTSE_MEM$CODE
url<-"https://www.londonstockexchange.com/exchange/searchengine/search.html?lang=en&x=0&y=0&q="
SEARCH<-paste0(url,CODE[[1]])
webpage<-read_html(SEARCH)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE
FTSE_TABLE$Name[1]
LSE_NAME_LIST<-list()
for (i in 1:length:CODE){
url<-"https://www.londonstockexchange.com/exchange/searchengine/search.html?lang=en&x=0&y=0&q="
SEARCH<-paste0(url,CODE[[1]])
webpage<-read_html(SEARCH)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
LSE_NAME_LIST[[i]]<-FTSE_TABLE$Name[1]
}
for (i in 31:length:CODE){
url<-"https://www.londonstockexchange.com/exchange/searchengine/search.html?lang=en&x=0&y=0&q="
SEARCH<-paste0(url,CODE[[1]])
webpage<-read_html(SEARCH)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
LSE_NAME_LIST[[i]]<-FTSE_TABLE$Name[1]
}
LSE_NAME_LIST<-list()
for (i in 1:length(CODE)){
url<-"https://www.londonstockexchange.com/exchange/searchengine/search.html?lang=en&x=0&y=0&q="
SEARCH<-paste0(url,CODE[[i]])
webpage<-read_html(SEARCH)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
LSE_NAME_LIST[[i]]<-FTSE_TABLE$Name[1]
}
LSE_NAME<-data.frame(CODE=CODE,
NAME_LSE=unlist(LSE_NAME_LIST))
View(LSE_NAME)
LSE_NAME$edit<-gsub("Ord.*","",LSE_NAME$NAME_LSE)
View(LSE_NAME)
LSE_NAME$edit<-gsub("ORD.*","",LSE_NAME$NAME_LSE)
View(LSE_NAME)
View(LSE_NAME)
save(LSE_NAME,file="LSE_NAME.RData")
View(LSE_NAME_LIST)
View(LSE_NAME)
write.csv(LSE_NAME,"LSE_NAME.csv")
library(rvest)
library(purrr)
library(magrittr)
library(xlsx)
FTSE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
FTSE_LIST<-list()
for (i in 1:18){
url<-paste0(FTSE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE<-FTSE_TABLE[,1:6]
colnames(FTSE_TABLE)<-c("CODE","NAME","CUR","PRICE",
"POINT_CHANGE","PERCENT_CHANGE")
FTSE_LIST[[i]]<-FTSE_TABLE
}
FTSE_350_DF<-map_df(FTSE_LIST,data.frame)
FTSE_350_DF$DATE<-Sys.Date()
sheet_name<-as.character(Sys.Date())
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
library(rvest)
FTSE_URL<-"https://www.reuters.com/finance/stocks/company-officers/"
url<-paste0(FTSE_URL,CODE2[[i]])
webpage<-read_html(SEARCH)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE$company_code<-CODE[[i]]
FTSE_TABLE$Name[1]
LSE_NAME_LIST<-list()
for (i in 1:length(CODE)){
url<-"https://www.londonstockexchange.com/exchange/searchengine/search.html?lang=en&x=0&y=0&q="
SEARCH<-paste0(url,CODE[[i]])
webpage<-read_html(SEARCH)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
LSE_NAME_LIST[[i]]<-FTSE_TABLE$Name[1]
}
LSE_NAME<-data.frame(CODE=CODE,
NAME_LSE=unlist(LSE_NAME_LIST))
LSE_NAME$edit<-gsub("ORD.*","",LSE_NAME$NAME_LSE)
View(LSE_NAME)
colnames(LSE_NAME)
colnames(FTSE_350_DF)
FTSE_350_DF<-merge(FTSE_350_DF,LSE_NAME,by="code")
FTSE_350_DF<-merge(FTSE_350_DF,LSE_NAME,by="CODE")
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
library(tidyverse)
colnames(FTSE_350_DF)
FTSE_350_DF<-select(FTSE_350_DF,-NAME_LSE)
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
install.packages("xlsx")
install.packages("rtweet")
library(rtweet)
library(purrr)
library(magrittr)
library(xlsx)
wb <- loadWorkbook("FTSE_350_FIRM_LIST.xlsx")
sheets <- getSheets(wb)
View(sheets)
i<-1
FILE<-read.xlsx("FTSE_350_FIRM_LIST.xlsx", sheetName = sheets[[i]])
sheets[[i]]
sheets
sheets <- getSheets(wb)%>%unlist()
View(sheets)
H<-map_df(sheets,data.frame)
names(sheets)
SS<-names(sheets)
FILE<-read.xlsx("FTSE_350_FIRM_LIST.xlsx", sheetName = SS[[i]])
FILE<-read.xlsx("FTSE_350_FIRM_LIST.xlsx", sheetName = SS[[3]])
FIRMS<-FILE$FULL.NAME
FIRMS<-FILE$FULL.NAME%>%as.character()
ftse_tweet_list<-lis
ftse_tweet_list<-list()
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 10)
View(usrs)
tweets_data(usrs)
HH<-tweets_data(usrs)
View(HH)
ftse_tweet_list<-list()
for (i in 1:length(FIRMS)){
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 10)
DF<-tibble(firm_name=FF,
twitter_screen_name=usrs)
ftse_tweet_list[[i]]<-DF
}
library(tibble)
library(purrr)
ftse_tweet_list<-list()
for (i in 1:length(FIRMS)){
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 10)
DF<-tibble(firm_name=FF,
twitter_screen_name=usrs)
ftse_tweet_list[[i]]<-DF
}
ftse_tweet_df<-map_df(ftse_tweet_list,data.frame)
View(ftse_tweet_list)
ftse_tweet_df<-map_df(ftse_tweet_list,data.frame)
i<1
i<-1
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 1)
ftse_tweet_list<-list()
for (i in 1:length(FIRMS)){
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 1)
DF<-tibble(firm_name=FF,
twitter_screen_name=usrs$screen_name)
ftse_tweet_list[[i]]<-DF
}
SN<-usrs$screen_name
is.null(SN)
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 1)
SN<-usrs$screen_name
if (is.null(SN)){
screen_name<-"NA"
}else{
screen_name<-SN
}
ftse_tweet_list<-list()
for (i in 1:length(FIRMS)){
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 1)
SN<-usrs$screen_name
if (is.null(SN)){
screen_name<-"NA"
}else{
screen_name<-SN
}
DF<-tibble(firm_name=FF,
twitter_screen_name=screen_name)
ftse_tweet_list[[i]]<-DF
}
ftse_tweet_df<-map_df(ftse_tweet_list,data.frame)
write_csv(ftse_tweet_df,paste0("FTSE_TWEET_",SS[[3]],".csv")
)
library(readr)
write_csv(ftse_tweet_df,paste0("FTSE_TWEET_",SS[[3]],".csv"))
FILE<-read.xlsx("FTSE_350_FIRM_LIST.xlsx", sheetName = SS[[2]])
FIRMS<-FILE$FULL.NAME%>%as.character()
ftse_tweet_list<-list()
for (i in 1:length(FIRMS)){
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 1)
SN<-usrs$screen_name
if (is.null(SN)){
screen_name<-"NA"
}else{
screen_name<-SN
}
DF<-tibble(firm_name=FF,
twitter_screen_name=screen_name)
ftse_tweet_list[[i]]<-DF
}
wb <- loadWorkbook("FTSE_350_FIRM_LIST.xlsx")
sheets <- getSheets(wb)
SS<-names(sheets)
FILE<-read.xlsx("FTSE_350_FIRM_LIST.xlsx", sheetName = SS[[2]])
FIRMS<-FILE$FULL.NAME%>%as.character()
FIRMS<-FILE$NAME>%as.character()
FILE<-read.xlsx("FTSE_350_FIRM_LIST.xlsx", sheetName = SS[[3]])
FIRMS<-FILE$FULL.NAME%>%as.character()
ftse_tweet_list<-list()
for (i in 1:length(FIRMS)){
FF<-FIRMS[[i]]
usrs <- search_users(FF, n = 1)
SN<-usrs$screen_name
if (is.null(SN)){
FF2<-gsub(" PLC","",FF)
USER2<-search_users(FF, n = 1)
SN2<-USER2$screen_name
if (is.null(SN2)){
screen_name<-"NA"
}else{
screen_name<-SN2
}
}else{
screen_name<-SN
}
DF<-tibble(firm_name=FF,
twitter_screen_name=screen_name)
ftse_tweet_list[[i]]<-DF
}
ftse_tweet_df<-map_df(ftse_tweet_list,data.frame)
library(readr)
write_csv(ftse_tweet_df,paste0("FTSE_TWEET_",SS[[3]],"2.csv"))
ALL_SHARE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/summary/summary-indices-constituents.html?index=ASX&page="
library(rvest)
library(purrr)
library(magrittr)
library(xlsx)
#FTSE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
ALL_SHARE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/summary/summary-indices-constituents.html?index=ASX&page="
AS_LIST<-list()
for (i in 1:31){
url<-paste0(ALL_SHARE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE<-FTSE_TABLE[,1:6]
colnames(FTSE_TABLE)<-c("CODE","NAME","CUR","PRICE",
"POINT_CHANGE","PERCENT_CHANGE")
AS_LIST[[i]]<-FTSE_TABLE
}
ALL_SHARE_FTSE_DF<-map_df(AS_LIST,data.frame)
i<-1
url<-paste0(ALL_SHARE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
View(FTSE_TABLE)
FTSE_TABLE<-FTSE_TABLE[,1:6]
colnames(FTSE_TABLE)<-c("CODE","NAME","CUR","PRICE",
"POINT_CHANGE","PERCENT_CHANGE")
AS_LIST<-list()
for (i in 1:31){
url<-paste0(ALL_SHARE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE<-FTSE_TABLE[,1:2]
colnames(FTSE_TABLE)<-c("CODE","NAME"#,"CUR","PRICE",
#"POINT_CHANGE","PERCENT_CHANGE"
)
AS_LIST[[i]]<-FTSE_TABLE
}
ALL_SHARE_FTSE_DF<-map_df(AS_LIST,data.frame)
ALL_SHARE_FTSE_DF$DATE<-Sys.Date()
sheet_name<-as.character(Sys.Date())
write.xlsx(ALL_SHARE_FTSE_DF, file = "ALL_SHARE_FTSE_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
#FTSE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
AIM_SHARE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/summary/summary-indices-constituents.html?index=AXX&page="
AIM_LIST<-list()
for (i in 1:37){
url<-paste0(AIM_SHARE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE<-FTSE_TABLE[,1:2]
colnames(FTSE_TABLE)<-c("CODE","NAME"#,"CUR","PRICE",
#"POINT_CHANGE","PERCENT_CHANGE"
)
AIM_LIST[[i]]<-FTSE_TABLE
}
AIM_DF<-map_df(AIM_LIST,data.frame)
AIM_DF$DATE<-Sys.Date()
sheet_name<-as.character(Sys.Date())
write.xlsx(AIM_DF, file = "AIM_ALL_SHARE_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
