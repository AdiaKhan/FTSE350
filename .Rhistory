FTSE_LINK<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
library(rvest)
webpage <- read_html(url)
FTSE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
webpage <- read_html(FTSE_URL)
DATA<-html_text(rank_data_html)
DATA<-html_text(webpage)
DATA<-html_table(webpage)
View(DATA)
D1<-DATA[[1]]
View(D1)
FTSE_LIST<-list()
FTSE_LIST
FTSE_URL
#CODE NAME	CUR	PRICE	POINT_CHANGE	PERCENT_CHANGE
FTSE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
#CODE NAME	CUR	PRICE	POINT_CHANGE	PERCENT_CHANGE
FTSE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
FTSE_LIST<-list()
i<-12
i<-1
url<-paste0(FTSE_URL,i)
FTSE_DATA<-html_table(webpage)
FTSE_DATA<-html_table(url)
FTSE_DATA<-html_table(webpage)
FTSE_TABLE<-FTSE_DATA[[1]]
url<-paste0(FTSE_URL,i)
webpage<-read_html(url)
FTSE_DATA<-html_table(webpage)
FTSE_TABLE<-FTSE_DATA[[1]]
url<-paste0(FTSE_URL,i)
webpage<-read_html(url)
url<-paste0(FTSE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
View(FTSE_TABLE)
#CODE NAME	CUR	PRICE	POINT_CHANGE	PERCENT_CHANGE
library(rvest)
library(magrittr)
FTSE_TABLE<-FTSE_TABLE[,1:6]
FTSE_LIST<-list()
for (i in 1:18){
url<-paste0(FTSE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE<-FTSE_TABLE[,1:6]
colnames(FTSE_TABLE)<-c("CODE","NAME","CUR","PRICE",
"POINT_CHANGE","PERCENT_CHANGE")
FTSE_LIST[[i]]<-FTSE_TABLE
}
FTSE_350_DF<-map_df(FTSE_LIST,data.frame)
library(purrr)
FTSE_350_DF<-map_df(FTSE_LIST,data.frame)
View(FTSE_350_DF)
FTSE_350_DF$DATE<-Sys.Date()
View(FTSE_350_DF)
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xls", sheetName=Sys.Date(),
append=TRUE)
??write_xlsx
??write.xlsx
library(xlsx)
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xls", sheetName=Sys.Date(),
append=TRUE)
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xls", sheetName=Sys.Date(),
append=TRUE)
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=Sys.Date(),
append=TRUE)
Sys.Date()
library(rJava)
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=Sys.Date(),
append=TRUE)
xl<-as.character(Sys.Date())
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=xl,
append=TRUE)
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
sheet_name<-as.character(Sys.Date())
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
library(rvest)
library(purrr)
library(magrittr)
library(xlsx)
FTSE_URL<-"https://www.londonstockexchange.com/exchange/prices-and-markets/stocks/indices/constituents-indices.html?index=NMX&page="
FTSE_LIST<-list()
for (i in 1:18){
url<-paste0(FTSE_URL,i)
webpage<-read_html(url)%>%
html_table()
FTSE_TABLE<-webpage[[1]]
FTSE_TABLE<-FTSE_TABLE[,1:6]
colnames(FTSE_TABLE)<-c("CODE","NAME","CUR","PRICE",
"POINT_CHANGE","PERCENT_CHANGE")
FTSE_LIST[[i]]<-FTSE_TABLE
}
FTSE_350_DF<-map_df(FTSE_LIST,data.frame)
FTSE_350_DF$DATE<-Sys.Date()
sheet_name<-as.character(Sys.Date())
write.xlsx(FTSE_350_DF, file = "FTSE_350_FIRM_LIST.xlsx",
sheetName=sheet_name,
append=TRUE)
